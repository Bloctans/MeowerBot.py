# This workflow will install Python dependencies, run tests and lint with a variety of Python versions
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-python

name: Python package

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:
      build:
        runs-on: ubuntu-latest
        strategy:
          matrix:
            python-version: [3.8]
        steps:
          - name: Checkout code
            uses: actions/checkout@v2
          - name: Set up Python ${{ matrix.python-version }}
            uses: actions/setup-python@v2
            with:
              python-version: ${{ matrix.python-version }}
          - name: Install Poetry
            uses: snok/install-poetry@v1
            with:
              version: latest
              virtualenvs-create: true
              virtualenvs-in-project: true
          - name: Install Dependencies
            run: |
              $act
              pip install bandit
              poetry install --no-interaction

          - name: Run Tests
            run: |
              python -m poetry run "unittest discover -s tests"
          - name: Run Linter
            run: |
              bandit -r my_project